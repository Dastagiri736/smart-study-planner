<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Study Planner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="bg-light">

  <!-- AUTH MODAL -->
  <div class="modal fade" id="auth-modal" tabindex="-1" aria-hidden="true" aria-labelledby="auth-title">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-4">
        <h2 id="auth-title" class="text-center mb-3">🔐 Welcome to Smart Study Planner</h2>
        <div class="mb-3">
          <label for="auth-username" class="form-label">Username</label>
          <input type="text" id="auth-username" class="form-control" required />
        </div>
        <div class="mb-3">
          <label for="auth-password" class="form-label">Password</label>
          <input type="password" id="auth-password" class="form-control" required />
        </div>
        <div class="d-grid gap-2">
          <button id="login-btn" class="btn btn-success">Login</button>
          <button id="signup-btn" class="btn btn-primary">Sign Up</button>
        </div>
        <p id="auth-message" class="mt-3 text-center" aria-live="polite"></p>
      </div>
    </div>
  </div>

  <!-- TASK MODAL -->
  <div class="modal fade" id="task-modal" tabindex="-1" aria-hidden="true" aria-labelledby="task-title">
    <div class="modal-dialog">
      <div class="modal-content p-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 id="task-title">📌 Task Details</h5>
          <button type="button" class="btn-close" id="close-modal" aria-label="Close"></button>
        </div>
        <div id="modal-details" class="mb-3" tabindex="0"></div>
        <div class="d-flex gap-2">
          <button id="edit-task-btn" class="btn btn-warning flex-fill">Edit Task</button>
          <button id="delete-task-btn" class="btn btn-danger flex-fill">Delete Task</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PLANNER CONTAINER -->
  <div class="container my-4" id="planner-container" style="display:none;">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="text-success text-center flex-grow-1">Smart Study Planner</h1>
      <div class="d-flex gap-2">
        <button id="logout-btn" class="btn btn-outline-danger">🚪 Logout</button>
      </div>
    </div>

    <div class="text-center mb-3 welcome-message" id="welcome-message" aria-live="polite"></div>

    <!-- TASK FORM -->
    <form id="task-form" class="row g-2 mb-3">
      <input type="hidden" id="editing-task-id" value="" /> 

      <div class="col-md-3">
        <label for="start-date" class="form-label">Start Date</label>
        <input type="date" id="start-date" class="form-control" required min="" />
      </div>
      <div class="col-md-3">
        <label for="subject" class="form-label">Subject</label>
        <input type="text" id="subject" class="form-control" placeholder="e.g., Math" required />
      </div>
      <div class="col-md-3">
        <label for="task" class="form-label">Task Description</label>
        <input type="text" id="task" class="form-control" placeholder="e.g., Solve chapter 5" required />
      </div>
      <div class="col-md-3">
        <label for="due-date" class="form-label">Due Date</label>
        <input type="date" id="due-date" class="form-control" required />
      </div>
      <div class="col-md-3">
        <label for="priority" class="form-label">Priority</label>
        <select id="priority" class="form-select" required>
          <option value="" disabled selected>Select Priority</option>
          <option value="High">High</option>
          <option value="Medium">Medium</option>
          <option value="Low">Low</option>
        </select>
      </div>

      <div class="col-md-3" id="task-form-actions">
        <label class="form-label">&nbsp;</label>
        <button type="submit" id="add-task-submit" class="btn btn-success w-100">Add Task</button>

        <div id="edit-task-actions" class="d-grid gap-2" style="display: none;">
        </div>
      </div>
    </form>

    <!-- PROGRESS BAR -->
    <div class="mb-3">
      <label for="progress-bar" class="form-label">Progress:</label>
      <div class="progress">
        <div id="progress-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%"></div>
      </div>
    </div>

    <div class="row">
      <section class="col-lg-6 mb-4">
        <h2>📅 Weekly Timeline</h2>
        <div class="d-flex gap-2 mb-2">
          <button id="prev-week" class="btn btn-outline-secondary">← Prev Week</button>
          <label for="calendar-start-date" class="form-label ms-2">View Week Starting:</label>
          <input type="date" id="calendar-start-date" class="form-control ms-2" style="width: auto;" />
          <button id="next-week" class="btn btn-outline-secondary">Next Week →</button>
        </div>
        <div class="calendar d-grid gap-2" id="calendar" role="grid"></div>
      </section>
      <section class="col-lg-6 mb-4">
        <h2>🗓️ Upcoming Tasks</h2>
        <ul id="task-list" class="list-group" role="list"></ul>
      </section>
    </div>
  </div>

  <!-- LOADING SPINNER -->
  <div id="loading-spinner" class="spinner-border text-success position-fixed top-50 start-50 translate-middle" style="display: none;">
    <span class="visually-hidden">Loading...</span>
  </div>

  <!-- TOAST ALERT -->
  <div id="toast-alert" class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header">
        <strong id="toast-title" class="me-auto"></strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
      </div>
      <div class="toast-body" id="toast-body"></div>
    </div>
  </div>

  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script defer src="script.js"></script>

  <footer class="footer mt-auto py-3 bg-light text-center text-muted" id="main-footer">
    <div class="container">
      <span>© 2025 Smart Study Planner. All rights reserved.</span><br />
      <span>Made with ❤️ by Giri</span>
    </div>
  </footer>

</body>
</html>
